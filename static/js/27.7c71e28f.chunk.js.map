{"version":3,"file":"static/js/27.7c71e28f.chunk.js","mappings":"0WAgBaA,EAAuB,WAClC,IAAMC,GAAWC,EAAAA,EAAAA,MACTC,GAAaC,EAAAA,EAAAA,MAAbD,SACR,GAAyDE,EAAAA,EAAAA,MAAjDC,EAAR,EAAQA,cAAeC,EAAvB,EAAuBA,OAAQC,EAA/B,EAA+BA,UAAWC,EAA1C,EAA0CA,WAClCC,EAASH,EAATG,KACAC,GAAcC,EAAAA,EAAAA,KAAdD,UACFE,GAAWC,EAAAA,EAAAA,MACXC,IAAkB,OAAIC,OAAOC,OAAOX,IAAgBY,MACxD,SAACC,GAAD,OAAmB,IAATA,CAAV,IAmDF,OAzCAC,EAAAA,EAAAA,YAAU,WACR,GAAIjB,IAAaQ,EAAY,GAAKD,EAAO,IAQvC,GAPIC,EAAY,GACdV,GAASoB,EAAAA,EAAAA,OAAeC,SAAQ,WAC9BrB,GAASsB,EAAAA,EAAAA,OAAgBD,SAAQ,WAEhC,GACF,IAECZ,EAAO,IAAkB,IAAbP,EAAmB,CACjCqB,QAAQC,IAAR,oCAAyCf,EAAzC,MACA,IAAMgB,EAAW,mCAAG,WAAOC,GAAP,qFACCA,GADD,+DACPC,EADO,iBAEV3B,EAAS2B,KAFC,qMAAH,sDAKjBF,EAAY,CACVL,EAAAA,GACA,WACER,EAAS,WACV,GAEJ,OAGCE,IACFd,GAAS4B,EAAAA,EAAAA,OACT5B,GAAS6B,EAAAA,EAAAA,IAAgBtB,IACzBP,GAAS8B,EAAAA,EAAAA,OAEZ,GAAE,CACD9B,EACAE,EACAY,EACAJ,EACAD,EACAF,EACAK,EACAJ,KAIA,kBAAMuB,UAAS,UAAKC,EAAAA,EAAAA,MAApB,WAEE,SAAC,KAAD,CAAUC,GAAG,WACb,SAAC,IAAD,KACA,SAAC,IAAD,KACA,SAAC,IAAD,CAAOC,MAAM,wBAGlB,EAED,W","sources":["pages/ReturnFromCombatPage.js"],"sourcesContent":["import { useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Title } from \"components/Title/Title\";\nimport {\n  getEnemyGold,\n  levelupAndReloadDungeon,\n} from \"redux/dungeon/operations\";\nimport { clearCombat } from \"redux/combat/operations\";\nimport { Navigate, useNavigate } from \"react-router-dom\";\nimport { useCombat, useDungeon } from \"hooks\";\nimport { useEnemy } from \"hooks/useEnemy\";\nimport { LvUpDungeonById, playerLvUp } from \"redux/game/operations\";\nimport { Loader } from \"components/Loader/Loader\";\nimport { Background } from \"components/Background/Background\";\nimport css from \"./Page.module.css\";\n\nexport const ReturnFromCombatPage = () => {\n  const dispatch = useDispatch();\n  const { inCombat } = useCombat();\n  const { slotsDefeated, player, dungeonId, goldEarned } = useDungeon();\n  const { life } = player;\n  const { enemyLife } = useEnemy();\n  const navigate = useNavigate();\n  const dungeonVictory = ![...Object.values(slotsDefeated)].some(\n    (slot) => slot === false\n  );\n  // const error = useSelector(selectError);\n  // const loading = useSelector(selectLoading);\n\n  // useEffect(() => {\n  //   console.log(` ReturnFromCombatPage rendering START`);\n  //   return () => console.log(` ReturnFromCombatPage rendering END`);\n  // }, []);\n\n  useEffect(() => {\n    if (inCombat && (enemyLife < 1 || life < 1)) {\n      if (enemyLife < 1) {\n        dispatch(clearCombat()).finally(() => {\n          dispatch(getEnemyGold()).finally(() => {\n            //\n          });\n        });\n      }\n      if (life < 1 && inCombat === true) {\n        console.log(`Return page: player life [${life}]`);\n        const runDispatch = async (toDispatch) => {\n          for (const func of toDispatch) {\n            await dispatch(func());\n          }\n        };\n        runDispatch([\n          clearCombat,\n          () => {\n            navigate(\"/summary\");\n          },\n        ]);\n      }\n      return;\n    }\n    if (dungeonVictory) {\n      dispatch(playerLvUp());\n      dispatch(LvUpDungeonById(dungeonId));\n      dispatch(levelupAndReloadDungeon());\n    }\n  }, [\n    dispatch,\n    inCombat,\n    dungeonVictory,\n    enemyLife,\n    life,\n    dungeonId,\n    navigate,\n    goldEarned,\n  ]);\n\n  return (\n    <main className={`${css.main}`}>\n      {/* {error ? <span className={css.error}>{error}</span> : \"\"} */}\n      <Navigate to=\"/town\" />\n      <Background />\n      <Loader />\n      <Title title=\"Picking up gold..\" />\n    </main>\n  );\n};\n\nexport default ReturnFromCombatPage;\n"],"names":["ReturnFromCombatPage","dispatch","useDispatch","inCombat","useCombat","useDungeon","slotsDefeated","player","dungeonId","goldEarned","life","enemyLife","useEnemy","navigate","useNavigate","dungeonVictory","Object","values","some","slot","useEffect","clearCombat","finally","getEnemyGold","console","log","runDispatch","toDispatch","func","playerLvUp","LvUpDungeonById","levelupAndReloadDungeon","className","css","to","title"],"sourceRoot":""}